<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classroom</title>
    <link rel="icon" href="https://ssl.gstatic.com/classroom/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:100,300,400,500,700,900,100i,300i,400i,500i,700i,900i">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Google Sans', sans-serif;
            transition: background-color 0.3s, color 0.3s;
            background-color: #f3f4f6;
        }
        body.dark {
            background-color: #121212 !important;
            color: #e0e0e0
        }
        .dark .bg-white {
            background-color: #1e1e1e;
        }
        .dark .text-gray-800 {
            color: #f0f0f0;
        }
        .dark .text-gray-700 {
            color: #d1d5db;
        }
        .dark .text-gray-600 {
            color: #b0b0b0;
        }
        .dark .border-gray-300 {
            border-color: #444;
        }
        .dark .bg-gray-100 {
            background-color: #2d3748;
        }
        .dark .bg-gray-200 {
            background-color: #333;
        }
        .dark .border-gray-300 {
            border-color: #555;
        }
        .dark .text-gray-500 {
            color: #888;
        }
        .dark .bg-gray-700 {
            background-color: #2a2a2a;
        }
        .dark .hover\:bg-gray-200:hover {
            background-color: #374151;
        }
        .dark .hover\:bg-gray-300:hover {
            background-color: #4b5563;
        }
        .dark .hover\:text-gray-700:hover {
            color: #fff;
        }
        .dark #archiveList li {
             background-color: #2d3748;
             border-color: #4a5568;
        }
        .dark .history-card:hover {
            background-color: #374151;
        }
        .page-transition {
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            transform: translateY(16px);
            opacity: 0;
        }
        .page-transition.active {
            transform: translateY(0);
            opacity: 1;
        }
        .tab-button.active {
            border-bottom: 2px solid #3b82f6;
            color: #3b82f6;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        input[type="checkbox"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            display: inline-block;
            height: 1.25rem; 
            width: 1.25rem;
            background-color: #e5e7eb;
            border: 2px solid #9ca3af;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            flex-shrink: 0;
        }
        input[type="checkbox"]:checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }
        input[type="checkbox"]:checked:before {
            content: '';
            display: block;
            width: 0.5rem;
            height: 0.75rem;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg) translate(25%, -25%);
        }
        .dark input[type="checkbox"] {
            background-color: #374151;
            border-color: #6b7280; 
        }
        .dark input[type="checkbox"]:checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }
        .dark input[type="text"] {
            background-color: #2d3748;
            color: #e2e8f0;
            border-color: #4a5568;
        }
        .history-card {
            cursor: pointer;
        }
        .history-loop-container, .history-loop-container input, .history-loop-container label {
            cursor: pointer;
        }
        .history-loop-container {
            flex-shrink: 0;
        }
        .history-loop-container:hover {
            background-color: rgba(0,0,0,0.05);
            border-radius: 6px;
        }
        .dark .history-loop-container:hover {
             background-color: rgba(255,255,255,0.08);
        }

        /* --- Bubble Animation Styles --- */
        #bubble-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }
        .bubble {
            position: absolute;
            bottom: -100px;
            /* MODIFIED: Increased opacity from 0.3 to 0.6 and added a glow */
            background-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
            border-radius: 50%;
            animation: floatUp linear infinite;
        }
        @keyframes floatUp {
            0% {
                transform: translateY(0) translateX(0);
                opacity: 1;
            }
            50% {
                transform: translateX(20px);
            }
            100% {
                transform: translateY(-120vh) translateX(-20px);
                opacity: 0;
            }
        }
        /* Make sure the main content is on top of the bubbles */
        #main-container {
            position: relative;
            z-index: 1;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 transition-colors">
    <div id="bubble-background"></div>

    <div id="main-container" class="bg-white p-8 rounded-xl shadow-lg w-full max-w-4xl text-center transition-colors">
        
        <div id="mainPage" class="page-transition">
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center space-x-3">
                    <img src="https://avatars.githubusercontent.com/u/57332930?s=200&v=4" alt="Lunar Logo" class="h-10 w-10 rounded-full">
                    <h1 class="text-3xl font-bold text-gray-800">Lunar Launcher V2.3</h1>
                </div>
                <div class="flex space-x-2">
                    <button id="archiveButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">History</button>
                    <button id="settingsButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">Settings</button>
                    <button id="updateLogButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">Update Log</button>
                    <button id="themeToggle" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors">
                        <svg id="moonIcon" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                        <svg id="sunIcon" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                    </button>
                </div>
            </div>
            <p id="greetingText" class="text-xl font-medium text-gray-800 mb-4"></p>
            <p class="text-gray-600 mb-4">Enter a YouTube video or playlist URL or ID to launch it in a new tab.</p>
            
            <div class="mb-4">
                <input type="text" id="videoInput" placeholder="Paste YouTube URL or ID here" class="flex-grow w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
            </div>

            <div class="flex items-center justify-center mb-6">
                <input type="checkbox" id="loopCheckbox" class="h-5 w-5 rounded text-blue-600 focus:ring-2 focus:ring-blue-500">
                <label for="loopCheckbox" class="ml-2 text-gray-700 select-none">Loop video (only for single videos)</label>
            </div>

            <button id="goButton" class="bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-200 w-full">Launch</button>
        </div>

        <div id="archivePage" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromArchiveButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Launch History</h1>
            </div>
            <ul id="archiveList" class="text-left max-h-96 overflow-y-auto space-y-3 pr-2">
            </ul>
            <button id="clearHistoryBtn" class="bg-red-600 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-red-700 transition duration-200 mt-6">Clear History</button>
        </div>

        <div id="settingsPage" class="page-transition hidden">
            <div class="flex justify-between items-center mb-6">
                <button id="backFromSettingsButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">Back</button>
                <h2 class="text-2xl font-bold text-gray-800">Settings</h2>
                <div class="flex space-x-2">
                    <button id="profileButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">Profile</button>
                    <button id="helpButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">Help</button>
                    <button id="creditsButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">Credits</button>
                </div>
            </div>
            
            <div class="text-left">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Cloak Settings</h3>
                <div class="space-y-4">
                    <div>
                        <label for="cloakTitleInput" class="block text-gray-700 mb-2">Website Title:</label>
                        <input type="text" id="cloakTitleInput" placeholder="Enter new title" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label for="cloakFaviconInput" class="block text-gray-700 mb-2">Favicon URL:</label>
                        <input type="text" id="cloakFaviconInput" placeholder="Enter new favicon URL" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label for="videoTabTitleInput" class="block text-gray-700 mb-2">Video Tab Title:</label>
                        <input type="text" id="videoTabTitleInput" placeholder="Enter new title for video tab" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button id="saveCloakButton" class="w-full px-4 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">
                        Save Cloak Settings
                    </button>
                </div>
            </div>
        </div>

        <div id="helpPage" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromHelpButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Help</h1>
            </div>
            <p class="text-gray-600 text-left mb-4">
                Welcome to Lunar Launcher! This tool allows you to easily open YouTube videos and playlists in a new tab. This can be useful for focusing on the video content without distractions.
            </p>
            <p class="text-gray-600 text-left mb-4">
                Simply paste a YouTube video URL, video ID, or playlist URL into the text box on the main page. The launcher will automatically detect the video and playlist IDs from the link.
            </p>
            <p class="text-gray-600 text-left">
                You can also customize the appearance of the launcher and the video tabs in the Settings menu. This includes changing the title and favicon to make it look like a different website.
            </p>
        </div>

        <div id="updateLogMainPage" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromUpdateLogMainButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Update Log</h1>
            </div>
            <div class="text-left space-y-4">
                <button class="update-log-version-button w-full text-left p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors" data-target="v23Page">
                    <h3 class="text-xl font-semibold text-gray-800">V2.3 - September 14, 2025</h3>
                </button>
                <button class="update-log-version-button w-full text-left p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors" data-target="v22Page">
                    <h3 class="text-xl font-semibold text-gray-800">V2.2 - September 14, 2025</h3>
                </button>
                <button class="update-log-version-button w-full text-left p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors" data-target="v21Page">
                    <h3 class="text-xl font-semibold text-gray-800">V2.1 - September 13, 2025</h3>
                </button>
                <button class="update-log-version-button w-full text-left p-4 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors" data-target="v20Page">
                    <h3 class="text-xl font-semibold text-gray-800">V2.0 - September 10, 2025</h3>
                </button>
            </div>
        </div>

        <div id="v23Page" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromV23Button" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Update V2.3</h1>
            </div>
            <div class="text-left p-4 bg-gray-100 rounded-lg">
                <h3 class="text-xl font-semibold text-gray-800">V2.3 - September 14, 2025</h3>
                <ul class="list-disc list-inside mt-2 text-gray-600">
                    <li><strong>Rich History:</strong> The history page now shows video thumbnails and titles for a better browsing experience.</li>
                    <li>Added <strong>Credits Page</strong> to settings.</li>
                    <li>Fixed minor bugs.</li>
                </ul>
            </div>
        </div>
        
        <div id="v22Page" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromV22Button" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                     <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Update V2.2</h1>
            </div>
            <div class="text-left p-4 bg-gray-100 rounded-lg">
                <h3 class="text-xl font-semibold text-gray-800">V2.2 - September 14, 2025</h3>
                <ul class="list-disc list-inside mt-2 text-gray-600">
                    <li>Moved <strong>Help & Username Page</strong> to settings.</li>
                    <li>Added <strong>Username Page.</strong></li>
                    <li>Redesigned the <strong>Checkbox</strong>.</li>
                    <li>Fixed major bugs.</li>
                </ul>
            </div>
        </div>
        
        <div id="v21Page" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromV21Button" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Update V2.1</h1>
            </div>
            <div class="text-left p-4 bg-gray-100 rounded-lg">
                <h3 class="text-xl font-semibold text-gray-800">V2.1 - September 13, 2025</h3>
                <ul class="list-disc list-inside mt-2 text-gray-600">
                    <li><strong>Help Page</strong> Added the help page.</li>
                    <li><strong>Fixed Bold Text</strong> Lunar Team officially fixed Bold Text.</li>
                    <li><strong>Transitions</strong> Added Smooth keyframe transitions.</li>
                    <li>Minor bug fixes and performance improvements.</li>
                </ul>
            </div>
        </div>

        <div id="v20Page" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromV20Button" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Update V2.0</h1>
            </div>
            <div class="text-left p-4 bg-gray-100 rounded-lg">
                <h3 class="text-xl font-semibold text-gray-800">V2.0 - September 10, 2025</h3>
                <ul class="list-disc list-inside mt-2 text-gray-600">
                    <li><strong>Playlist Looping:</strong> Lunar has officially added Playlist looping.</li>
                    <li><strong>Video Looping:</strong> Lunar has officially added Video Looping allowing users to loop videos.</li>
                </ul>
            </div>
        </div>

        <div id="profilePage" class="page-transition hidden">
            <div class="flex justify-between items-center mb-6">
                <button id="backFromProfileButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">Back</button>
                <h2 class="text-2xl font-bold text-gray-800">Profile</h2>
                <div></div> </div>
            
            <div class="text-left">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Username</h3>
                <div class="space-y-4">
                    <div>
                        <label for="usernameInput" class="block text-gray-700 mb-2">Enter your username:</label>
                        <input type="text" id="usernameInput" placeholder="e.g., JohnDoe" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button id="saveUsernameButton" class="w-full px-4 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">
                        Save Username
                    </button>
                    <div id="currentUsernameDisplay" class="mt-4 text-gray-700"></div>
                </div>
            </div>
        </div>

        <div id="creditsPage" class="page-transition hidden">
            <div class="flex items-center mb-6">
                <button id="backFromCreditsButton" class="p-2 rounded-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors text-sm font-medium">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 class="text-3xl font-bold text-gray-800 ml-4">Credits</h1>
            </div>
            <div class="text-left space-y-4">
                <div>
                    <h3 class="text-xl font-semibold text-gray-800">Development Team</h3>
                    <p class="text-gray-600 mt-2">
                        Lunar Launcher was designed and developed by the Lunar Team.
                    </p>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-gray-800">Technologies Used</h3>
                    <ul class="list-disc list-inside mt-2 text-gray-600">
                        <li>HTML5</li>
                        <li>Tailwind CSS</li>
                        <li>JavaScript</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-gray-800">Special Thanks</h3>
                    <p class="text-gray-600 mt-2">
                        A big thank you to the open-source community for providing the tools and inspiration for this project.
                    </p>
                </div>
            </div>
        </div>

        <div id="messageBox" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white p-6 rounded-lg shadow-xl text-center max-w-sm mx-4">
                <p id="messageText" class="text-gray-800 mb-4"></p>
                <button id="closeMessage" class="bg-red-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-600 transition duration-200">Close</button>
            </div>
        </div>
        
        <div id="welcomeModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white p-8 rounded-xl shadow-xl text-center w-full max-w-xl mx-4">
                <div class="border-b border-gray-200 mb-6">
                    <nav class="-mb-px flex justify-center space-x-8" aria-label="Tabs">
                        <button class="tab-button active py-4 px-1 text-center font-medium text-sm text-gray-500 hover:text-gray-700 focus:outline-none" data-tab="welcome">
                            Welcome
                        </button>
                        <button class="tab-button py-4 px-1 text-center font-medium text-sm text-gray-500 hover:text-gray-700 focus:outline-none" data-tab="whats-new">
                            What's New
                        </button>
                        <button class="tab-button py-4 px-1 text-center font-medium text-sm text-gray-500 hover:text-gray-700 focus:outline-none" data-tab="about">
                            About
                        </button>
                    </nav>
                </div>
                
                <div id="welcome-tab" class="tab-content active text-left">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">Welcome to Lunar Launcher!</h2>
                    <p class="text-gray-600 mb-4">
                        This tool allows you to easily open YouTube videos and playlists in a new tab, helping you to focus on the content without distractions.
                    </p>
                    <p class="text-gray-600">
                        Use the buttons and inputs to get started. You can also customize your experience in the Settings menu.
                    </p>
                </div>

                <div id="whats-new-tab" class="tab-content text-left">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">What's New in Version 2.3</h2>
                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                        <li><strong>Rich History:</strong> The history page now loads with video thumbnails and titles for a better browsing experience!</li>
                        <li><strong>UI/UX Improvements:</strong> Squashed some minor bugs and polished the user interface for a smoother experience.</li>
                         <li><strong>Better Cloaking:</strong> The main tab will now redirect to Google after launching a video to improve cloaking.</li>
                    </ul>
                </div>

                <div id="about-tab" class="tab-content text-left">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800">About Lunar Launcher</h2>
                    <p class="text-gray-600 mb-4">
                        Lunar Launcher was created to provide a simple, clean, and distraction-free way to watch YouTube content. It's a quick and easy solution for launching videos and playlists without the clutter of the standard YouTube interface with no ads!!.
                    </p>
                    <p class="text-gray-600">
                        We hope you enjoy using it! -livid
                    </p>
                </div>

                <div class="mt-8">
                    <button id="closeWelcomeButton" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-200">
                        Get Started
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const currentVersion = '2.3';

            // --- DOM Element Selection ---
            const videoInput = document.getElementById('videoInput');
            const goButton = document.getElementById('goButton');
            const loopCheckbox = document.getElementById('loopCheckbox');
            const messageBox = document.getElementById('messageBox');
            const messageText = document.getElementById('messageText');
            const closeMessage = document.getElementById('closeMessage');
            const themeToggle = document.getElementById('themeToggle');
            const sunIcon = document.getElementById('sunIcon');
            const moonIcon = document.getElementById('moonIcon');
            const bubbleContainer = document.getElementById('bubble-background');
            
            const allPages = document.querySelectorAll('.page-transition');
            const mainPage = document.getElementById('mainPage');
            const settingsPage = document.getElementById('settingsPage');
            const helpPage = document.getElementById('helpPage');
            const updateLogMainPage = document.getElementById('updateLogMainPage');
            const v23Page = document.getElementById('v23Page');
            const v22Page = document.getElementById('v22Page');
            const v21Page = document.getElementById('v21Page');
            const v20Page = document.getElementById('v20Page');
            const profilePage = document.getElementById('profilePage');
            const creditsPage = document.getElementById('creditsPage');
            const archivePage = document.getElementById('archivePage'); 

            // Buttons
            const settingsButton = document.getElementById('settingsButton');
            const updateLogButton = document.getElementById('updateLogButton');
            const creditsButton = document.getElementById('creditsButton');
            const profileButton = document.getElementById('profileButton');
            const helpButton = document.getElementById('helpButton');
            const archiveButton = document.getElementById('archiveButton');
            const backFromSettingsButton = document.getElementById('backFromSettingsButton');
            const backFromHelpButton = document.getElementById('backFromHelpButton');
            const backFromUpdateLogMainButton = document.getElementById('backFromUpdateLogMainButton');
            const backFromV23Button = document.getElementById('backFromV23Button');
            const backFromV22Button = document.getElementById('backFromV22Button');
            const backFromV21Button = document.getElementById('backFromV21Button');
            const backFromV20Button = document.getElementById('backFromV20Button');
            const backFromProfileButton = document.getElementById('backFromProfileButton');
            const backFromCreditsButton = document.getElementById('backFromCreditsButton');
            const backFromArchiveButton = document.getElementById('backFromArchiveButton');

            // Cloak Settings
            const cloakTitleInput = document.getElementById('cloakTitleInput');
            const cloakFaviconInput = document.getElementById('cloakFaviconInput');
            const videoTabTitleInput = document.getElementById('videoTabTitleInput');
            const saveCloakButton = document.getElementById('saveCloakButton');

            // Profile
            const usernameInput = document.getElementById('usernameInput');
            const saveUsernameButton = document.getElementById('saveUsernameButton');
            const currentUsernameDisplay = document.getElementById('currentUsernameDisplay');
            const greetingText = document.getElementById('greetingText');
            
            // Welcome Modal
            const welcomeModal = document.getElementById('welcomeModal');
            const closeWelcomeButton = document.getElementById('closeWelcomeButton');
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            // Archive
            const archiveList = document.getElementById('archiveList');
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            const historyStorageKey = 'lunarLauncherHistory';

            // --- Bubble Animation ---
            function createBubble() {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                const size = Math.random() * 40 + 10;
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                bubble.style.left = `${Math.random() * 100}%`;
                bubble.style.animationDuration = `${Math.random() * 10 + 10}s`;
                bubble.style.animationDelay = `${Math.random() * 5}s`;
                bubbleContainer.appendChild(bubble);

                setTimeout(() => {
                    bubble.remove();
                }, 8888888);
            }

            function generateBubbles(count) {
                for (let i = 0; i < count; i++) {
                    createBubble();
                }
                setInterval(createBubble, 500);
            }

            // --- Update Popup Logic ---
            function checkVersion() {
                const lastSeenVersion = localStorage.getItem('lastSeenVersion');
                if (lastSeenVersion !== currentVersion) {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.querySelector('.tab-button[data-tab="whats-new"]').classList.add('active');
                    document.getElementById('whats-new-tab').classList.add('active');
                    welcomeModal.classList.remove('hidden');
                }
            }

            // --- Page Navigation ---
            function showPage(pageToShow) {
                allPages.forEach(p => {
                    if (p) {
                        p.classList.add('hidden');
                        p.classList.remove('active');
                    }
                });
                if (pageToShow) {
                    pageToShow.classList.remove('hidden');
                    void pageToShow.offsetWidth;
                    pageToShow.classList.add('active');
                }
            }

            // --- Messaging ---
            function showMessage(message, isSuccess = true) {
                messageText.textContent = message;
                messageBox.classList.remove('hidden');
            }

            // --- Theme Management ---
            function applyTheme(theme) {
                if (theme === 'dark') {
                    document.body.classList.add('dark');
                    moonIcon.classList.add('hidden');
                    sunIcon.classList.remove('hidden');
                } else {
                    document.body.classList.remove('dark');
                    moonIcon.classList.remove('hidden');
                    sunIcon.classList.add('hidden');
                }
                localStorage.setItem('theme', theme);
            }
            themeToggle.addEventListener('click', () => applyTheme(document.body.classList.contains('dark') ? 'light' : 'dark'));

            // --- Greeting and Profile ---
            function setGreeting() {
                const username = localStorage.getItem('username');
                const hour = new Date().getHours();
                let greeting = (hour < 12) ? 'Good Morning' : (hour < 18) ? 'Good Afternoon' : 'Good Evening';
                greetingText.textContent = username ? `${greeting}, ${username}!` : `${greeting}!`;
            }
            function loadUsername() {
                const savedUsername = localStorage.getItem('username');
                usernameInput.value = savedUsername || '';
                currentUsernameDisplay.textContent = savedUsername ? `Current Username: ${savedUsername}` : 'No username saved.';
            }
            saveUsernameButton.addEventListener('click', () => {
                const username = usernameInput.value.trim();
                if (username) {
                    localStorage.setItem('username', username);
                    loadUsername(); setGreeting();
                    showMessage("Username saved!");
                } else { showMessage("Please enter a valid username.", false); }
            });

            // --- Cloak Settings ---
            function loadCloakSettings() {
                const title = localStorage.getItem('cloakTitle') || 'Classroom';
                const favicon = localStorage.getItem('cloakFavicon') || 'https://ssl.gstatic.com/classroom/favicon.png';
                const videoTitle = localStorage.getItem('videoTabTitle') || 'Classroom';
                document.title = title;
                document.querySelector("link[rel='icon']").href = favicon;
                cloakTitleInput.value = title;
                cloakFaviconInput.value = favicon;
                videoTabTitleInput.value = videoTitle;
            }
            saveCloakButton.addEventListener('click', () => {
                localStorage.setItem('cloakTitle', cloakTitleInput.value.trim());
                localStorage.setItem('cloakFavicon', cloakFaviconInput.value.trim());
                localStorage.setItem('videoTabTitle', videoTabTitleInput.value.trim());
                loadCloakSettings();
                showMessage("Cloak settings saved and applied!");
            });
            
            // --- ARCHIVE/HISTORY FUNCTIONS ---
            function getHistory() {
                return JSON.parse(localStorage.getItem(historyStorageKey)) || [];
            }
            function saveHistory(url) {
                const history = getHistory();
                const filteredHistory = history.filter(item => item.url !== url);
                filteredHistory.unshift({ url: url, launchedAt: new Date().toLocaleString() });
                if (filteredHistory.length > 50) filteredHistory.pop();
                localStorage.setItem(historyStorageKey, JSON.stringify(filteredHistory));
            }

            async function renderHistory() {
                archiveList.innerHTML = '<li class="text-gray-500 text-center p-4">Loading history...</li>';
                const history = getHistory();
                if (history.length === 0) {
                    archiveList.innerHTML = '<li class="text-gray-500 text-center p-4">No videos have been launched yet.</li>';
                    clearHistoryBtn.classList.add('hidden');
                    return;
                }
                clearHistoryBtn.classList.remove('hidden');

                const videoIdRegex = /(?:v=|\/embed\/|\.be\/|v\/|e\/|watch\?v=|\&v=)([^#\&\?]{11})/;
                let historyHtml = '';

                for (const item of history) {
                    const videoIdMatch = item.url.match(videoIdRegex);
                    let cardHtml;

                    if (videoIdMatch) {
                        try {
                            const response = await fetch(`https://noembed.com/embed?url=https://www.youtube.com/watch?v=${videoIdMatch[1]}`);
                            if (!response.ok) throw new Error('Network response was not ok');
                            const data = await response.json();
                            if (data.error) throw new Error('Video not found or private');

                            cardHtml = `
                                <div class="flex items-center space-x-4 p-3 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors history-card" data-url="${item.url}">
                                    <img src="${data.thumbnail_url}" alt="Video Thumbnail" class="w-32 h-18 object-cover rounded-md flex-shrink-0">
                                    <div class="flex-grow overflow-hidden">
                                        <p class="font-semibold truncate text-gray-800">${data.title}</p>
                                        <p class="text-sm text-gray-500">${item.launchedAt}</p>
                                    </div>
                                    <div class="flex items-center space-x-2 p-2 history-loop-container">
                                        <input type="checkbox" class="history-loop-checkbox">
                                        <label class="text-gray-700 select-none">Loop</label>
                                    </div>
                                </div>`;
                        } catch (error) {
                            cardHtml = `<div class="flex items-center space-x-4 p-3 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors history-card" data-url="${item.url}">
                                            <div class="w-32 h-18 bg-gray-300 rounded-md flex-shrink-0 flex items-center justify-center text-gray-500">No Thumb</div>
                                            <div class="flex-grow"><p class="font-medium truncate text-gray-800">${item.url}</p><p class="text-sm text-gray-500">${item.launchedAt}</p></div>
                                            <div class="flex items-center space-x-2 p-2 history-loop-container"><input type="checkbox" class="history-loop-checkbox"><label class="text-gray-700 select-none">Loop</label></div>
                                        </div>`;
                        }
                    } else {
                         cardHtml = `<div class="flex items-center space-x-4 p-3 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors history-card" data-url="${item.url}">
                                        <div class="w-32 h-18 bg-gray-300 rounded-md flex-shrink-0 flex items-center justify-center text-gray-500">Playlist</div>
                                        <div class="flex-grow"><p class="font-medium truncate text-gray-800">${item.url}</p><p class="text-sm text-gray-500">${item.launchedAt}</p></div>
                                    </div>`;
                    }
                    historyHtml += `<li>${cardHtml}</li>`;
                }
                archiveList.innerHTML = historyHtml;
            }

            archiveList.addEventListener('click', (e) => {
                const card = e.target.closest('.history-card');
                const loopContainer = e.target.closest('.history-loop-container');
                if (loopContainer) return;
                if (card) {
                    const url = card.dataset.url;
                    const loopCheckboxEl = card.querySelector('.history-loop-checkbox');
                    const shouldLoop = loopCheckboxEl ? loopCheckboxEl.checked : false;
                    launchVideo(url, shouldLoop);
                }
            });

            clearHistoryBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear your entire launch history?')) {
                    localStorage.removeItem(historyStorageKey);
                    renderHistory();
                }
            });
            
            // --- Core Launcher Logic ---
            function launchVideo(urlToLaunch = null, loopOverride = null) {
                const input = urlToLaunch || videoInput.value.trim();
                const shouldLoop = loopOverride !== null ? loopOverride : loopCheckbox.checked;
                
                if (!input) {
                    showMessage("Please enter a URL or ID.", false);
                    return;
                }

                const videoIdRegex = /(?:v=|\/embed\/|\.be\/|v\/|e\/|watch\?v=|\&v=)([^#\&\?]{11})/;
                const playlistIdRegex = /(?:list=)([^#\&\?]*)/;
                
                const videoIdMatch = input.match(videoIdRegex);
                const playlistIdMatch = input.match(playlistIdRegex);

                let embedUrl;
                if (playlistIdMatch) {
                    embedUrl = `https://www.youtube.com/embed/videoseries?list=${playlistIdMatch[1]}&autoplay=1`;
                } else if (videoIdMatch) {
                    embedUrl = `https://www.youtube.com/embed/${videoIdMatch[1]}?autoplay=1`;
                    if (shouldLoop) embedUrl += `&loop=1&playlist=${videoIdMatch[1]}`;
                } else {
                    embedUrl = `https://www.youtube.com/embed/${input}?autoplay=1`;
                }

                if (embedUrl) {
                    if (!urlToLaunch) saveHistory(input);
                    openAndRedirect(embedUrl);
                } else {
                    showMessage("Could not find a valid YouTube Video or Playlist ID.", false);
                }
            }

            function openAndRedirect(embedUrl) {
                const videoTabTitle = localStorage.getItem('videoTabTitle') || 'Classroom';
                const faviconUrl = localStorage.getItem('cloakFavicon') || 'https://ssl.gstatic.com/classroom/favicon.png';
                try {
                    const newWindow = window.open('about:blank', '_blank');
                    if (newWindow) {
                        newWindow.document.write(`<!DOCTYPE html><html><head><title>${videoTabTitle}</title><link rel="icon" href="${faviconUrl}" type="image/x-icon"><style>body,html{margin:0;padding:0;height:100%;overflow:hidden;background-color:#000}iframe{width:100%;height:100%;border:none}</style></head><body><iframe src="${embedUrl}" allow="autoplay; encrypted-media" allowfullscreen></iframe></body></html>`);
                        newWindow.document.close();
                        window.location.href = 'https://www.google.com';
                    } else {
                        showMessage("Pop-up blocked. Please allow pop-ups for this site.", false);
                    }
                } catch (e) { console.error("Failed to write to new window:", e); }
            }
            goButton.addEventListener('click', () => launchVideo());
            videoInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') launchVideo(); });

            // --- Welcome Modal Tabs ---
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.dataset.tab;
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    button.classList.add('active');
                    document.getElementById(targetTab + '-tab').classList.add('active');
                });
            });

            // --- Navigation Event Listeners ---
            settingsButton.addEventListener('click', () => showPage(settingsPage));
            updateLogButton.addEventListener('click', () => showPage(updateLogMainPage));
            creditsButton.addEventListener('click', () => showPage(creditsPage));
            profileButton.addEventListener('click', () => showPage(profilePage));
            helpButton.addEventListener('click', () => showPage(helpPage));
            archiveButton.addEventListener('click', () => {
                renderHistory();
                showPage(archivePage);
            });
            document.querySelectorAll('.update-log-version-button').forEach(button => {
                button.addEventListener('click', () => showPage(document.getElementById(button.dataset.target)));
            });
            backFromSettingsButton.addEventListener('click', () => showPage(mainPage));
            backFromUpdateLogMainButton.addEventListener('click', () => showPage(mainPage));
            backFromHelpButton.addEventListener('click', () => showPage(settingsPage));
            backFromCreditsButton.addEventListener('click', () => showPage(settingsPage));
            backFromProfileButton.addEventListener('click', () => showPage(settingsPage));
            backFromV23Button.addEventListener('click', () => showPage(updateLogMainPage));
            backFromV22Button.addEventListener('click', () => showPage(updateLogMainPage));
            backFromV21Button.addEventListener('click', () => showPage(updateLogMainPage));
            backFromV20Button.addEventListener('click', () => showPage(updateLogMainPage));
            backFromArchiveButton.addEventListener('click', () => showPage(mainPage));
            closeMessage.addEventListener('click', () => messageBox.classList.add('hidden'));
            
            closeWelcomeButton.addEventListener('click', () => {
                welcomeModal.classList.add('hidden');
                localStorage.setItem('lastSeenVersion', currentVersion);
            });

            // --- INITIALIZATION ---
            function initialize() {
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                applyTheme(savedTheme || (prefersDark ? 'dark' : 'light'));
                loadCloakSettings();
                loadUsername();
                setGreeting();
                showPage(mainPage);
                generateBubbles(45);
                checkVersion();
            }
            initialize();
        });
    </script>
</body>
</html>
